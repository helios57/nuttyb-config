{
  "label": "Cross Faction T2",
  "variable": "tweakdefs6",
  "generator": "json-schema",
  "definitions": [
    {
      "name": "Cross Faction Taxed Units",
      "description": "Creates taxed versions of T2 factories and labs",
      "scope": "UnitDefsLoop",
      "conditions": [
        { "type": "customParam", "key": "techlevel", "value": 2 },
        { "type": "customParamMatch", "key": "subfolder", "regex": "(Fact|Lab)" }
      ],
      "mutations": [
        {
          "op": "clone_unit",
          "source": "SELF",
          "targetSuffix": "_taxed",
          "mutations": [
            { "op": "multiply", "field": "energyCost", "factor": 1.7 },
            { "op": "multiply", "field": "metalCost", "factor": 1.7 },
            {
              "op": "set",
              "field": "name",
              "value": {
                "type": "math",
                "expression": "name + ' (Taxed)'",
                "variables": {}
              }
            },
            {
              "op": "table_merge",
              "field": "customparams",
              "value": {
                "i18n_en_humanname": {
                  "type": "math",
                  "expression": "humanname + ' (Taxed)'",
                  "variables": { "humanname": "customparams.i18n_en_humanname" }
                }
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Update Build Options for Taxed Units",
      "description": "Adds taxed units to build options of other factions",
      "scope": "UnitDefsLoop",
      "conditions": [
        { "type": "fieldValue", "field": "buildoptions", "value": true }
        // Note: 'value: true' for a list field implies 'has any value' or 'exists'.
        // The schema might need refinement for 'fieldExists', but 'fieldValue' with boolean might work if the engine supports it.
        // Alternatively, we rely on the fact that we are iterating all units and checking buildoptions.
      ],
      "mutations": [
        { "op": "raw_lua", "code": "-- Logic to add taxed units to buildoptions is complex (cross-faction check) and best left as raw_lua or a specific 'cross_faction_build_option' op for now." }
      ]
    }
  ]
}

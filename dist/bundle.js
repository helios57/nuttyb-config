/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={141(e,t,a){var n,o,r;e=a.nmd(e),function(s,i,l){"use strict";var c={function:!0,object:!0},u=c[typeof t]&&t&&!t.nodeType&&t,d=c.object&&e&&!e.nodeType&&e,p=u&&d&&"object"==typeof a.g&&a.g,m=d&&d.exports===u&&u;!p||p.global!==p&&p.window!==p&&p.self,o=[t],void 0===(r="function"==typeof(n=l)?n.apply(t,o):n)||(e.exports=r),u&&m&&l(d.exports)}(0,0,function(e){"use strict";var t,a,n;e.version="0.2.1";var o=e.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1,onCreateNode:null,onCreateScope:null,onDestroyScope:null},r=32,s=128;e.tokenTypes={EOF:1,StringLiteral:2,Keyword:4,Identifier:8,NumericLiteral:16,Punctuator:r,BooleanLiteral:64,NilLiteral:s,VarargLiteral:256};var i=e.errors={unexpected:"unexpected %1 '%2' near '%3'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",invalidVar:"invalid left-hand side of assignment near '%1'"},l=e.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,t){return{type:"IfClause",condition:e,body:t}},elseifClause:function(e,t){return{type:"ElseifClause",condition:e,body:t}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,t){return{type:"WhileStatement",condition:e,body:t}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,t){return{type:"RepeatStatement",condition:e,body:t}},localStatement:function(e,t){return{type:"LocalStatement",variables:e,init:t}},assignmentStatement:function(e,t){return{type:"AssignmentStatement",variables:e,init:t}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,t,a,n){return{type:"FunctionDeclaration",identifier:e,isLocal:a,parameters:t,body:n}},forNumericStatement:function(e,t,a,n,o){return{type:"ForNumericStatement",variable:e,start:t,end:a,step:n,body:o}},forGenericStatement:function(e,t,a){return{type:"ForGenericStatement",variables:e,iterators:t,body:a}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,t,a){return{type:e=2===e?"StringLiteral":16===e?"NumericLiteral":64===e?"BooleanLiteral":e===s?"NilLiteral":"VarargLiteral",value:t,raw:a}},tableKey:function(e,t){return{type:"TableKey",key:e,value:t}},tableKeyString:function(e,t){return{type:"TableKeyString",key:e,value:t}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,t,a){return{type:"and"===e||"or"===e?"LogicalExpression":"BinaryExpression",operator:e,left:t,right:a}},unaryExpression:function(e,t){return{type:"UnaryExpression",operator:e,argument:t}},memberExpression:function(e,t,a){return{type:"MemberExpression",indexer:t,identifier:a,base:e}},indexExpression:function(e,t){return{type:"IndexExpression",base:e,index:t}},callExpression:function(e,t){return{type:"CallExpression",base:e,arguments:t}},tableCallExpression:function(e,t){return{type:"TableCallExpression",base:e,arguments:t}},stringCallExpression:function(e,t){return{type:"StringCallExpression",base:e,argument:t}},comment:function(e,t){return{type:"Comment",value:e,raw:t}}};function c(e){if(K){var t=Z.pop();t.complete(),a.locations&&(e.loc=t.loc),a.ranges&&(e.range=t.range)}return a.onCreateNode&&a.onCreateNode(e),e}var u,d,p,m,f,h,b,v,y,g,x,k=Array.prototype.slice,w=(Object.prototype.toString,function(e,t){for(var a=0,n=e.length;a<n;a++)if(e[a]===t)return a;return-1});function _(e){var t=k.call(arguments,1);return e=e.replace(/%(\d)/g,function(e,a){return""+t[a-1]||""}),e}function S(e){var t,a,n=_.apply(null,k.call(arguments,1));throw void 0!==e.line?(a=e.range[0]-e.lineStart,(t=new SyntaxError(_("[%1:%2] %3",e.line,a,n))).line=e.line,t.index=e.range[0],t.column=a):(a=u-v+1,(t=new SyntaxError(_("[%1:%2] %3",b,a,n))).index=u,t.line=b,t.column=a),t}function C(e,t){S(t,i.expectedToken,e,t.value)}function $(e,t){if(void 0===t&&(t=m.value),void 0!==e.type){var a;switch(e.type){case 2:a="string";break;case 4:a="keyword";break;case 8:a="identifier";break;case 16:a="number";break;case r:a="symbol";break;case 64:a="boolean";break;case s:return S(e,i.unexpected,"symbol","nil",t)}return S(e,i.unexpected,a,e.value,t)}return S(e,i.unexpected,"symbol",e,t)}function E(){for(T();45===t.charCodeAt(u)&&45===t.charCodeAt(u+1);)B(),T();if(u>=n)return{type:1,value:"<eof>",line:b,lineStart:v,range:[u,u]};var e,a=t.charCodeAt(u),o=t.charCodeAt(u+1);if(h=u,function(e){return e>=65&&e<=90||e>=97&&e<=122||95===e}(a))return function(){for(var e,a;U(t.charCodeAt(++u)););return!function(e){switch(e.length){case 2:return"do"===e||"if"===e||"in"===e||"or"===e;case 3:return"and"===e||"end"===e||"for"===e||"not"===e;case 4:return"else"===e||"goto"===e||"then"===e;case 5:return"break"===e||"local"===e||"until"===e||"while"===e;case 6:return"elseif"===e||"repeat"===e||"return"===e;case 8:return"function"===e}return!1}(e=t.slice(h,u))?"true"===e||"false"===e?(a=64,e="true"===e):"nil"===e?(a=s,e=null):a=8:a=4,{type:a,value:e,line:b,lineStart:v,range:[h,u]}}();switch(a){case 39:case 34:return function(){for(var e,a=t.charCodeAt(u++),o=u,r="";u<n&&a!==(e=t.charCodeAt(u++));)92===e?(r+=t.slice(o,u-1)+H(),o=u):(u>=n||G(e))&&(r+=t.slice(o,u-1),S({},i.unfinishedString,r+String.fromCharCode(e)));return{type:2,value:r+=t.slice(o,u-1),line:b,lineStart:v,range:[h,u]}}();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return P();case 46:return D(o)?P():46===o?46===t.charCodeAt(u+2)?{type:256,value:"...",line:b,lineStart:v,range:[h,u+=3]}:M(".."):M(".");case 61:return M(61===o?"==":"=");case 62:return M(61===o?">=":62===o?">>":">");case 60:return M(60===o?"<<":61===o?"<=":"<");case 126:return M(61===o?"~=":"~");case 58:return M(58===o?"::":":");case 91:return 91===o||61===o?(!1===(e=A())&&S(d,i.expected,"[",d.value),{type:2,value:e,line:b,lineStart:v,range:[h,u]}):M("[");case 47:return M(47===o?"//":"/");case 42:case 94:case 37:case 44:case 123:case 124:case 125:case 93:case 40:case 41:case 59:case 38:case 35:case 45:case 43:return M(t.charAt(u))}return $(t.charAt(u))}function L(){var e=t.charCodeAt(u),a=t.charCodeAt(u+1);return!!G(e)&&(10===e&&13===a&&u++,13===e&&10===a&&u++,b++,v=++u,!0)}function T(){for(;u<n;)if(N(t.charCodeAt(u)))u++;else if(!L())break}function M(e){return u+=e.length,{type:r,value:e,line:b,lineStart:v,range:[h,u]}}function P(){var e=t.charAt(u),a=t.charAt(u+1);return{type:16,value:"0"===e&&"xX".indexOf(a||null)>=0?function(){var e,a,n,o,r=0,s=1,l=1;for(o=u+=2,R(t.charCodeAt(u))||S({},i.malformedNumber,t.slice(h,u));R(t.charCodeAt(u));)u++;if(e=parseInt(t.slice(o,u),16),"."===t.charAt(u)){for(a=++u;R(t.charCodeAt(u));)u++;r=t.slice(a,u),r=a===u?0:parseInt(r,16)/Math.pow(16,u-a)}if("pP".indexOf(t.charAt(u)||null)>=0){for(u++,"+-".indexOf(t.charAt(u)||null)>=0&&(l="+"===t.charAt(u++)?1:-1),n=u,D(t.charCodeAt(u))||S({},i.malformedNumber,t.slice(h,u));D(t.charCodeAt(u));)u++;s=t.slice(n,u),s=Math.pow(2,s*l)}return(e+r)*s}():function(){for(;D(t.charCodeAt(u));)u++;if("."===t.charAt(u))for(u++;D(t.charCodeAt(u));)u++;if("eE".indexOf(t.charAt(u)||null)>=0)for(u++,"+-".indexOf(t.charAt(u)||null)>=0&&u++,D(t.charCodeAt(u))||S({},i.malformedNumber,t.slice(h,u));D(t.charCodeAt(u));)u++;return parseFloat(t.slice(h,u))}(),line:b,lineStart:v,range:[h,u]}}function H(){var e=u;switch(t.charAt(u)){case"n":return u++,"\n";case"r":return u++,"\r";case"t":return u++,"\t";case"v":return u++,"\v";case"b":return u++,"\b";case"f":return u++,"\f";case"z":return u++,T(),"";case"x":return R(t.charCodeAt(u+1))&&R(t.charCodeAt(u+2))?(u+=3,"\\"+t.slice(e,u)):"\\"+t.charAt(u++);default:if(D(t.charCodeAt(u))){for(;D(t.charCodeAt(++u)););return"\\"+t.slice(e,u)}return t.charAt(u++)}}function B(){h=u,u+=2;var e=t.charAt(u),o="",r=!1,s=u,i=v,c=b;if("["===e&&(!1===(o=A())?o=e:r=!0),!r){for(;u<n&&!G(t.charCodeAt(u));)u++;a.comments&&(o=t.slice(s,u))}if(a.comments){var d=l.comment(o,t.slice(h,u));a.locations&&(d.loc={start:{line:c,column:h-i},end:{line:b,column:u-v}}),a.ranges&&(d.range=[h,u]),a.onCreateNode&&a.onCreateNode(d),f.push(d)}}function A(){var e,a=0,o="",r=!1;for(u++;"="===t.charAt(u+a);)a++;if("["!==t.charAt(u+a))return!1;for(u+=a+1,G(t.charCodeAt(u))&&L(),e=u;u<n;){if(G(t.charCodeAt(u))&&L(),"]"===t.charAt(u++)){r=!0;for(var s=0;s<a;s++)"="!==t.charAt(u+s)&&(r=!1);"]"!==t.charAt(u+a)&&(r=!1)}if(r)break}return o+=t.slice(e,u-1),u+=a+1,o}function I(){p=d,d=m,m=E()}function O(e){return e===d.value&&(I(),!0)}function V(e){e===d.value?I():S(d,i.expected,e,d.value)}function N(e){return 9===e||32===e||11===e||12===e}function G(e){return 10===e||13===e}function D(e){return e>=48&&e<=57}function R(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function U(e){return e>=65&&e<=90||e>=97&&e<=122||95===e||e>=48&&e<=57}function j(e){if(1===e.type)return!0;if(4!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}function F(){var e=Array.apply(null,y[g++]);y.push(e),a.onCreateScope&&a.onCreateScope()}function q(){y.pop(),g--,a.onDestroyScope&&a.onDestroyScope()}function Q(e){-1===w(y[g],e)&&y[g].push(e)}function z(e){Q(e.name),W(e,!0)}function W(e,t){t||-1!==function(e,t,a){for(var n=0,o=e.length;n<o;n++)if(e[n].name===a)return n;return-1}(x,0,e.name)||x.push(e),e.isLocal=t}function J(e){return-1!==w(y[g],e)}e.lex=E;var K,Z=[];function X(){return new Y(d)}function Y(e){a.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),a.ranges&&(this.range=[e.range[0],0])}function ee(){K&&Z.push(X())}function te(e){K&&Z.push(e)}function ae(e){for(var t,a=[];!j(d);){if("return"===d.value){a.push(ne());break}(t=ne())&&a.push(t)}return a}function ne(){if(ee(),4===d.type)switch(d.value){case"local":return I(),function(){var e;if(8===d.type){var t=[],n=[];do{e=re(),t.push(e)}while(O(","));if(O("="))do{var o=ce();n.push(o)}while(O(","));if(a.scope)for(var r=0,s=t.length;r<s;r++)z(t[r]);return c(l.localStatement(t,n))}if(O("function"))return e=re(),a.scope&&(z(e),F()),se(e,!0);C("<name>",d)}();case"if":return I(),function(){var e,t,n,o=[];for(K&&(n=Z[Z.length-1],Z.push(n)),e=ce(),V("then"),a.scope&&F(),t=ae(),a.scope&&q(),o.push(c(l.ifClause(e,t))),K&&(n=X());O("elseif");)te(n),e=ce(),V("then"),a.scope&&F(),t=ae(),a.scope&&q(),o.push(c(l.elseifClause(e,t))),K&&(n=X());return O("else")&&(K&&(n=new Y(p),Z.push(n)),a.scope&&F(),t=ae(),a.scope&&q(),o.push(c(l.elseClause(t)))),V("end"),c(l.ifStatement(o))}();case"return":return I(),function(){var e=[];if("end"!==d.value){var t=le();for(null!=t&&e.push(t);O(",");)t=ce(),e.push(t);O(";")}return c(l.returnStatement(e))}();case"function":return I(),se(function(){var e,t,n;for(K&&(n=X()),e=re(),a.scope&&(W(e,J(e.name)),F());O(".");)te(n),t=re(),e=c(l.memberExpression(e,".",t));return O(":")&&(te(n),t=re(),e=c(l.memberExpression(e,":",t)),a.scope&&Q("self")),e}());case"while":return I(),function(){var e=ce();V("do"),a.scope&&F();var t=ae();return a.scope&&q(),V("end"),c(l.whileStatement(e,t))}();case"for":return I(),function(){var e,t=re();if(a.scope&&(F(),z(t)),O("=")){var n=ce();V(",");var o=ce(),r=O(",")?ce():null;return V("do"),e=ae(),V("end"),a.scope&&q(),c(l.forNumericStatement(t,n,o,r,e))}for(var s=[t];O(",");)t=re(),a.scope&&z(t),s.push(t);V("in");var i=[];do{var u=ce();i.push(u)}while(O(","));return V("do"),e=ae(),V("end"),a.scope&&q(),c(l.forGenericStatement(s,i,e))}();case"repeat":return I(),function(){a.scope&&F();var e=ae();V("until");var t=ce();return a.scope&&q(),c(l.repeatStatement(t,e))}();case"break":return I(),c(l.breakStatement());case"do":return I(),function(){a.scope&&F();var e=ae();return a.scope&&q(),V("end"),c(l.doStatement(e))}();case"goto":return I(),function(){d.value;var e=re();return c(l.gotoStatement(e))}()}return r===d.type&&O("::")?(e=d.value,t=re(),a.scope&&(Q("::"+e+"::"),W(t,!0)),V("::"),c(l.labelStatement(t))):(K&&Z.pop(),O(";")?void 0:function(){var e,t,a=d;if(K&&(t=X()),null==(e=pe()))return $(d);if(",=".indexOf(d.value)>=0){var n,o=[e],r=[];for(oe(e);O(",");)null==(n=pe())&&C("<expression>",d),oe(n),o.push(n);V("=");do{n=ce(),r.push(n)}while(O(","));return te(t),c(l.assignmentStatement(o,r))}return function(e){switch(e.type){case"CallExpression":case"TableCallExpression":case"StringCallExpression":return!0}return!1}(e)?(te(t),c(l.callStatement(e))):$(a)}());var e,t}function oe(e){(e.inParens||-1===["Identifier","MemberExpression","IndexExpression"].indexOf(e.type))&&S(d,i.invalidVar,d.value)}function re(){ee();var e=d.value;return 8!==d.type&&C("<name>",d),I(),c(l.identifier(e))}function se(e,t){var n=[];if(V("("),!O(")"))for(;;)if(8===d.type){var o=re();if(a.scope&&z(o),n.push(o),O(","))continue;if(O(")"))break}else{if(256===d.type){n.push(fe()),V(")");break}C("<name> or '...'",d)}var r=ae();return V("end"),a.scope&&q(),t=t||!1,c(l.functionStatement(e,n,t,r))}function ie(){for(var e,t,a=[];;){if(ee(),r===d.type&&O("["))e=ce(),V("]"),V("="),t=ce(),a.push(c(l.tableKey(e,t)));else if(8===d.type)"="===m.value?(e=re(),I(),t=ce(),a.push(c(l.tableKeyString(e,t)))):(t=ce(),a.push(c(l.tableValue(t))));else{if(null==(t=le())){Z.pop();break}a.push(c(l.tableValue(t)))}if(!(",;".indexOf(d.value)>=0))break;I()}return V("}"),c(l.tableConstructorExpression(a))}function le(){return de(0)}function ce(){var e=le();if(null!=e)return e;C("<expression>",d)}function ue(e){var t=e.charCodeAt(0),a=e.length;if(1===a)switch(t){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}else if(2===a)switch(t){case 47:return 10;case 46:return 8;case 60:case 62:return"<<"===e||">>"===e?7:3;case 61:case 126:return 3;case 111:return 1}else if(97===t&&"and"===e)return 2;return 0}function de(e){var t,a,n,o=d.value;if(K&&(a=X()),function(e){return r===e.type?"#-~".indexOf(e.value)>=0:4===e.type&&"not"===e.value}(d)){ee(),I();var s=de(10);null==s&&C("<expression>",d),t=c(l.unaryExpression(o,s))}if(null==t&&null==(t=fe())&&(t=pe()),null==t)return null;for(;o=d.value,!(0===(n=r===d.type||4===d.type?ue(o):0)||n<=e);){"^"!==o&&".."!==o||n--,I();var i=de(n);null==i&&C("<expression>",d),K&&Z.push(a),t=c(l.binaryExpression(o,t,i))}return t}function pe(){var e,t,n,o,s;if(K&&(n=X()),8===d.type)t=d.value,e=re(),a.scope&&W(e,J(t));else{if(!O("("))return null;e=ce(),V(")"),e.inParens=!0}for(;;)if(r===d.type)switch(d.value){case"[":te(n),I(),o=ce(),e=c(l.indexExpression(e,o)),V("]");break;case".":te(n),I(),s=re(),e=c(l.memberExpression(e,".",s));break;case":":te(n),I(),s=re(),e=c(l.memberExpression(e,":",s)),te(n),e=me(e);break;case"(":case"{":te(n),e=me(e);break;default:return e}else{if(2!==d.type)break;te(n),e=me(e)}return e}function me(e){if(r===d.type)switch(d.value){case"(":I();var t=[],a=le();for(null!=a&&t.push(a);O(",");)a=ce(),t.push(a);return V(")"),c(l.callExpression(e,t));case"{":ee(),I();var n=ie();return c(l.tableCallExpression(e,n))}else if(2===d.type)return c(l.stringCallExpression(e,fe()));C("function arguments",d)}function fe(){var e,n=d.value,o=d.type;if(K&&(e=X()),466&o){te(e);var r=t.slice(d.range[0],d.range[1]);return I(),c(l.literal(o,n,r))}return 4===o&&"function"===n?(te(e),I(),a.scope&&F(),se(null)):O("{")?(te(e),ie()):void 0}function he(a){return t+=String(a),n=t.length,e}function be(e){void 0!==e&&he(e),t&&"#!"===t.substr(0,2)&&(t=t.replace(/^.*/,function(e){return e.replace(/./g," ")})),n=t.length,K=a.locations||a.ranges,m=E();var o=function(){I(),ee(),a.scope&&F();var e=ae();return a.scope&&q(),1!==d.type&&$(d),K&&!e.length&&(p=d),c(l.chunk(e))}();if(a.comments&&(o.comments=f),a.scope&&(o.globals=x),Z.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return o}Y.prototype.complete=function(){a.locations&&(this.loc.end.line=p.line,this.loc.end.column=p.range[1]-p.lineStart),a.ranges&&(this.range[1]=p.range[1])},e.parse=function(r,s){return void 0===s&&"object"==typeof r&&(s=r,r=void 0),s||(s={}),t=r||"",a=function(){for(var e,t,a=k.call(arguments),n={},o=0,r=a.length;o<r;o++)for(t in e=a[o])e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(o,s),u=0,b=1,v=0,n=t.length,y=[[]],g=0,x=[],Z=[],a.comments&&(f=[]),a.wait?e:be()},e.write=he,e.end=be})},729(e,t,a){var n;e=a.nmd(e),function(o){var r=(e&&e.exports,"object"==typeof a.g&&a.g);r.global!==r&&r.window!==r||(o=r);var s=o.luaparse||a(141);s.defaultOptions.comments=!1,s.defaultOptions.scope=!0;var i,l,c,u=s.parse,d=/[a-zA-Z_]/,p=/[a-zA-Z0-9_]/,m=/[0-9]/,f={or:1,and:2,"<":3,">":3,"<=":3,">=":3,"~=":3,"==":3,"..":5,"+":6,"-":6,"*":7,"/":7,"%":7,unarynot:8,"unary#":8,"unary-":8,"^":10},h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_"],b=h.length-1,v=function(e,t){for(var a=-1,n=e.length,o=n-1;++a<n;)t(e[a],a<o)},y=function(e,t){for(var a=-1,n=e.length;++a<n;)if(e[a]==t)return a},g={}.hasOwnProperty,x=function(e){var t="0",a="";if(e<1)return a;if(1==e)return t;for(;e;)1&e&&(a+=t),(e>>=1)&&(t+=t);return a};function k(e){switch(e.length){case 2:return"do"==e||"if"==e||"in"==e||"or"==e;case 3:return"and"==e||"end"==e||"for"==e||"nil"==e||"not"==e;case 4:return"else"==e||"goto"==e||"then"==e||"true"==e;case 5:return"break"==e||"false"==e||"local"==e||"until"==e||"while"==e;case 6:return"elseif"==e||"repeat"==e||"return"==e;case 8:return"function"==e}return!1}var w=function(e){if("self"==e)return e;if(g.call(l,e))return l[e];for(var t,a,n=i.length,o=n-1;o>=0;){if(t=i.charAt(o),(a=y(h,t))!=b)return k(i=i.substring(0,o)+h[a+1]+x(n-(o+1)))||y(c,i)>-1?w(e):(l[e]=i,i);--o}return i="a"+x(n),y(c,i)>-1?w(e):(l[e]=i,i)},_=function(e,t,a){a||(a=" ");var n=e.slice(-1),o=t.charAt(0);return""==n||""==o?e+t:d.test(n)?p.test(o)?e+a+t:e+t:m.test(n)?"("==o||"."!=o&&!d.test(o)?e+t:e+a+t:n==o&&"-"==n?e+a+t:e+t},S=function(e){var t="",a=e.type,n=e.inParens&&("BinaryExpression"==a||"FunctionDeclaration"==a||"TableConstructorExpression"==a||"LogicalExpression"==a||"StringLiteral"==a);return n&&(t+="("),t+=C(e),n&&(t+=")"),t},C=function(e,t){t=function(e,t){var a;if(t)for(a in t)g.call(t,a)&&(e[a]=t[a]);return e}({precedence:0,preserveIdentifiers:!1},t);var a,n,o,r="",s=e.type;if("Identifier"==s)r=e.isLocal&&!t.preserveIdentifiers?w(e.name):e.name;else if("StringLiteral"==s||"NumericLiteral"==s||"BooleanLiteral"==s||"NilLiteral"==s||"VarargLiteral"==s)r=e.raw;else if("LogicalExpression"==s||"BinaryExpression"==s)o=e.operator,a=f[o],n="left",r=C(e.left,{precedence:a,direction:"left",parent:o}),r=_(r,o),r=_(r,C(e.right,{precedence:a,direction:"right",parent:o})),"^"!=o&&".."!=o||(n="right"),(a<t.precedence||a==t.precedence&&n!=t.direction&&"+"!=t.parent&&("*"!=t.parent||"/"!=o&&"*"!=o))&&(r="("+r+")");else if("UnaryExpression"==s)o=e.operator,a=f["unary"+o],r=_(o,C(e.argument,{precedence:a})),a<t.precedence&&("^"!=t.parent||"right"!=t.direction)&&(r="("+r+")");else if("CallExpression"==s)r=S(e.base)+"(",v(e.arguments,function(e,t){r+=C(e),t&&(r+=",")}),r+=")";else if("TableCallExpression"==s)r=C(e.base)+C(e.arguments);else if("StringCallExpression"==s)r=C(e.base)+C(e.argument);else if("IndexExpression"==s)r=S(e.base)+"["+C(e.index)+"]";else if("MemberExpression"==s)r=S(e.base)+e.indexer+C(e.identifier,{preserveIdentifiers:!0});else if("FunctionDeclaration"==s)r="function(",e.parameters.length&&v(e.parameters,function(e,t){r+=e.name?w(e.name):e.value,t&&(r+=",")}),r=_(r+=")",$(e.body)),r=_(r,"end");else{if("TableConstructorExpression"!=s)throw TypeError("Unknown expression type: `"+s+"`");r="{",v(e.fields,function(e,t){"TableKey"==e.type?r+="["+C(e.key)+"]="+C(e.value):"TableValue"==e.type?r+=C(e.value):r+=C(e.key,{preserveIdentifiers:!0})+"="+C(e.value),t&&(r+=",")}),r+="}"}return r},$=function(e){var t="";return v(e,function(e){t=_(t,E(e),";")}),t},E=function(e){var t="",a=e.type;if("AssignmentStatement"==a)v(e.variables,function(e,a){t+=C(e),a&&(t+=",")}),t+="=",v(e.init,function(e,a){t+=C(e),a&&(t+=",")});else if("LocalStatement"==a)t="local ",v(e.variables,function(e,a){t+=w(e.name),a&&(t+=",")}),e.init.length&&(t+="=",v(e.init,function(e,a){t+=C(e),a&&(t+=",")}));else if("CallStatement"==a)t=C(e.expression);else if("IfStatement"==a)t=_("if",C(e.clauses[0].condition)),t=_(t,"then"),t=_(t,$(e.clauses[0].body)),v(e.clauses.slice(1),function(e){e.condition?(t=_(t,"elseif"),t=_(t,C(e.condition)),t=_(t,"then")):t=_(t,"else"),t=_(t,$(e.body))}),t=_(t,"end");else if("WhileStatement"==a)t=_("while",C(e.condition)),t=_(t,"do"),t=_(t,$(e.body)),t=_(t,"end");else if("DoStatement"==a)t=_("do",$(e.body)),t=_(t,"end");else if("ReturnStatement"==a)t="return",v(e.arguments,function(e,a){t=_(t,C(e)),a&&(t+=",")});else if("BreakStatement"==a)t="break";else if("RepeatStatement"==a)t=_("repeat",$(e.body)),t=_(t,"until"),t=_(t,C(e.condition));else if("FunctionDeclaration"==a)t=(e.isLocal?"local ":"")+"function ",t+=C(e.identifier),t+="(",e.parameters.length&&v(e.parameters,function(e,a){t+=e.name?w(e.name):e.value,a&&(t+=",")}),t=_(t+=")",$(e.body)),t=_(t,"end");else if("ForGenericStatement"==a)t="for ",v(e.variables,function(e,a){t+=w(e.name),a&&(t+=",")}),t+=" in",v(e.iterators,function(e,a){t=_(t,C(e)),a&&(t+=",")}),t=_(t,"do"),t=_(t,$(e.body)),t=_(t,"end");else if("ForNumericStatement"==a)t="for "+w(e.variable.name)+"=",t+=C(e.start)+","+C(e.end),e.step&&(t+=","+C(e.step)),t=_(t,"do"),t=_(t,$(e.body)),t=_(t,"end");else if("LabelStatement"==a)t="::"+w(e.label.name)+"::";else{if("GotoStatement"!=a)throw TypeError("Unknown statement type: `"+a+"`");t="goto "+w(e.label.name)}return t},L={version:"1.0.4",minify:function(e){var t="string"==typeof e?u(e):e;if(l={},c=[],i="9",!t.globals)throw Error("Missing required AST property: `globals`");return v(t.globals,function(e){var t=e.name;l[t]=t,c.push(t)}),$(t.body)}};void 0===(n=function(){return L}.call(t,a,t,e))||(e.exports=n)}(this)}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";const e={maps:[{name:"Full Metal Plate (12P)",commands:["!map Full Metal Plate","!addbox 82 82 117 117 2","!clearbox 1"]},{name:"Raptor Crater (16P)",commands:["!map Raptor Crater","!addbox 84 81 119 116 2","!clearbox 1","!teamsize 16"]},{name:"Raptor Crater Inverted (16P)",commands:["!map Raptor Crater","!disablemapdamage 0","!debugcommands invertmap","!addbox 84 81 119 116 2","!clearbox 1","!teamsize 16"]},{name:"Special Hotstepper (16P)",commands:["!map Special Hotstepper","!addbox 83 81 118 116 2","!clearbox 1","!map_lavatiderhythm disabled","!teamsize 16"]},{name:"To Kill The Middle (12P)",commands:["!map To Kill The Middle","!addbox 82 82 117 117 2","!clearbox 1","!teamsize 12"]},{name:"Ancient Bastion Remake (8P)",commands:["!map Ancient Bastion Remake","!addbox 0 0 100 200 1","!addbox 175 0 200 200 2","!teamsize 8"]},{name:"Ancient Vault (12P)",commands:["!map Ancient Vault","!addbox 0 0 200 120 1","!addbox 0 180 200 200 2","!teamsize 12"]},{name:"Bismuth Valley (8P)",commands:["!map Bismuth Valley","!addbox 0 0 64 200 1","!addbox 175 0 200 200 2","!teamsize 8"]},{name:"Darkside (12P)",commands:["!map Darkside","!addbox 0 0 64 200 1","!addbox 175 0 200 200 2","!teamsize 12"]},{name:"Flats and Forests (12P)",commands:["!map Flats and Forests","!addbox 0 0 64 200 1","!addbox 175 0 200 200 2","!teamsize 12"]},{name:"Special Creek (12P)",commands:["!map Special Creek","!addbox 158 0 200 200 2","!teamsize 12"]},{name:"Starwatcher (8P)",commands:["!map Starwatcher","!addbox 0 0 64 200 1","!addbox 175 0 200 200 2","!teamsize 8"]}],modes:[{name:"No Rush",commands:["!raptor_queentimemult 1.3","!raptor_spawncountmult 3","!raptor_firstwavesboost 6","!raptor_graceperiodmult 3"]},{name:"No Rush Solo",commands:["!raptor_queentimemult 1.3","!raptor_spawncountmult 3","!raptor_firstwavesboost 3","!raptor_graceperiodmult 2.7"]},{name:"Zero Grace",commands:["!raptor_queentimemult 1.4","!raptor_spawncountmult 3","!raptor_firstwavesboost 3","!raptor_graceperiodmult 0.1"]},{name:"Surrounded",commands:["!raptor_queentimemult 1.3","!raptor_spawncountmult 3","!raptor_firstwavesboost 6","!raptor_graceperiodmult 3","!addbox 60 60 140 140 1","!raptor_raptorstart avoid","!clearbox 2"]}],base:["!preset coop","!teamsize 12","!autobalance off","!assistdronesbuildpowermultiplier 1","!assistdronesenabled enabled","!commanderbuildersbuildpower 1000","!commanderbuildersenabled enabled","!commanderbuildersrange 1000","!disablemapdamage 1","!experimentalextraunits 1","!experimentallegionfaction 1","!experimentalshields bounceeverything","!maxunits 10000","!multiplier_builddistance 2","!multiplier_buildpower 2","!multiplier_buildtimecost 1","!multiplier_energyconversion 1","!multiplier_energycost 1","!multiplier_energyproduction 1","!multiplier_losrange 1","!multiplier_maxdamage 1","!multiplier_maxvelocity 1","!multiplier_metalcost 1","!multiplier_metalextraction 1","!multiplier_radarrange 1","!multiplier_resourceincome 2","!multiplier_shieldpower 2","!multiplier_turnrate 1","!multiplier_weapondamage 1","!multiplier_weaponrange 1","!raptor_difficulty epic","!raptor_spawntimemult 1","!releasecandidates 1","!startenergy 10000","!startenergystorage 10000","!startmetal 10000","!startmetalstorage 10000","!scavunitsforplayers 1","!forceallunits 1","!unit_restrictions_noair 0","!unit_restrictions_noendgamelrpc 0","!unit_restrictions_noextractors 1","!unit_restrictions_nolrpc 0","!unit_restrictions_nonukes 0","!draft_mode disabled","!unit_restrictions_notacnukes 0","$welcome-message Settings made with NuttyB Configurator https://helios57.github.io/nuttyb-config/","!unit_market 0","!evocom 0","!nowasting all","!bSet unit_restrictions_nonukes 1","!bSet raptor_queen_count 8","!balance"],scavengers:["!scav_boss_count 8","!scav_bosstimemult 1.3","!scav_difficulty epic","!scav_spawncountmult 2","!bSet ruins disabled","!shieldsrework 1","!unit_restrictions_noextractors 0"]},t=[{label:"NuttyB Main Tweaks",type:"checkbox",column:"left",default:!0,commandBlocks:[],description:"Enables the core NuttyB tweaks and settings."},{label:"NuttyB Evolving Commanders",type:"checkbox",column:"left",default:!1,commandBlocks:["!evocom 1"],description:"Enables evolving commanders functionality."},{label:"Optimization & Scaling",type:"header",column:"left"},{label:"Enable Singularity Fusion",type:"checkbox",column:"left",default:!1,modOption:"fusion_mode",commandBlocks:[],description:"Allows fusion reactors to merge into more powerful singularity fusions."},{label:"Fusion - Min Tier",type:"numeric-tweak",column:"left",defaultValue:"1",min:1,step:1,modOption:"fusion_mintier",description:"Minimum tech tier required for fusion structures."},{label:"Fusion Efficiency Bonus",type:"numeric-tweak",column:"left",defaultValue:"1.10",min:1,step:.05,modOption:"fusion_efficiency",description:"Multiplier for fusion energy output efficiency."},{label:"Enable Adaptive Spawner",type:"checkbox",column:"left",default:!1,modOption:"adaptive_spawner",commandBlocks:[],description:"Spawns compressed units to reduce unit count while maintaining difficulty."},{label:"Max Compression Factor",type:"numeric-tweak",column:"left",defaultValue:"10",min:1,max:10,step:1,modOption:"adaptive_compression_max",description:"Maximum compression ratio for adaptive spawning (e.g., 10x)."},{label:"Enable Vampire Merge",type:"checkbox",column:"left",default:!1,modOption:"adaptive_vampire",commandBlocks:[],description:"Allows compressed units to absorb others on collision to regain health."},{label:"Enable Boss Tint",type:"checkbox",column:"left",default:!1,modOption:"adaptive_boss_tint",commandBlocks:[],description:"Applies a visual tint to boss units."},{label:"Enable Auto-Culling",type:"checkbox",column:"left",default:!1,modOption:"cull_enabled",commandBlocks:[],description:"Automatically removes older or lower-tier units to improve performance."},{label:"Culling - Min SimSpeed",type:"numeric-tweak",column:"left",defaultValue:"0.9",min:.1,step:.1,modOption:"cull_simspeed",description:"SimSpeed threshold below which culling activates."},{label:"Culling - Max Units",type:"numeric-tweak",column:"left",defaultValue:"5000",min:100,step:100,modOption:"cull_maxunits",description:"Maximum number of units allowed before culling starts."},{label:"Safe Zone Radius",type:"numeric-tweak",column:"left",defaultValue:"2000",min:500,step:100,modOption:"cull_radius",description:"Radius around start point where units are safe from culling."},{label:"Mechanics & Balance",type:"checkbox",column:"left",default:!0,commandBlocks:[]},{label:"Cross Faction T2",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Allows building T2 units from other factions."},{label:"T3 Eco",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Enables Tech 3 economy structures."},{label:"T3 Builders",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Enables Tech 3 construction units."},{label:"Unit Launchers",type:"checkbox",column:"left",default:!1,commandBlocks:[],tweakTemplateId:"tweak_enable_unit_launchers",description:"Enables unit launcher structures."},{label:"LRPC Rebalance v2",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Applies version 2 rebalance to Long Range Plasma Cannons."},{label:"T4 Defences Test",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Enables experimental T4 defensive structures."},{label:"T4 Air Rework",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Reworks T4 air units for better balance."},{label:"Mega Nuke",type:"checkbox",column:"left",default:!1,commandBlocks:[],description:"Enables the Mega Nuke weapon."},{label:"Raptor Health",type:"select",isHpGenerator:!0,hpType:"hp",column:"left",slot:"",slotType:"tweakdefs",defaultValue:"1.3",choices:[{label:"Default",value:"",shortLabel:""},{label:"1x HP",value:"1",shortLabel:"1x HP"},{label:"1.3x HP",value:"1.3",shortLabel:"1_3x HP"},{label:"1.5x HP",value:"1.5",shortLabel:"1_5x HP"},{label:"1.7x HP",value:"1.7",shortLabel:"1_7x HP"},{label:"2x HP",value:"2",shortLabel:"2x HP"},{label:"2.5x HP",value:"2.5",shortLabel:"2_5x HP"},{label:"3x HP",value:"3",shortLabel:"3x HP"},{label:"4x HP",value:"4",shortLabel:"4x HP"},{label:"5x HP",value:"5",shortLabel:"5x HP"}],description:"Multiplies the health of Raptor units."},{label:"Queen Health",type:"select",isHpGenerator:!0,hpType:"qhp",column:"left",slot:1,slotType:"tweakdefs",defaultValue:"1.3",choices:[{label:"Default",value:"",shortLabel:""},{label:"1x QHP",value:"1",shortLabel:"1x QHP"},{label:"1.3x QHP",value:"1.3",shortLabel:"1_3x QHP"},{label:"1.5x QHP",value:"1.5",shortLabel:"1_5x QHP"},{label:"1.7x QHP",value:"1.7",shortLabel:"1_7x QHP"},{label:"2x QHP",value:"2",shortLabel:"2x QHP"},{label:"2.5x QHP",value:"2.5",shortLabel:"2_5x QHP"},{label:"3x QHP",value:"3",shortLabel:"3x QHP"},{label:"4x QHP",value:"4",shortLabel:"4x QHP"},{label:"5x QHP",value:"5",shortLabel:"5x QHP"}],description:"Multiplies the health of Queen units."},{label:"Limit Max Allowed",type:"header",column:"left"},{label:"T3 Builders",type:"numeric-tweak",column:"left",defaultValue:"10",min:0,unitLabel:"max/unit",tweakTemplateId:"tweak_limit_t3builders",tweakVar:"limit",description:"Limits the maximum number of T3 Builders."},{label:"Unit Launchers",type:"numeric-tweak",column:"left",defaultValue:"20",min:0,unitLabel:"max/unit",tweakTemplateId:"tweak_limit_unit_launchers",tweakVar:"limit",description:"Limits the maximum number of Unit Launchers."},{label:"Epic Ragnarok",type:"numeric-tweak",column:"left",defaultValue:"80",min:0,unitLabel:"max/unit",tweakTemplateId:"tweak_limit_epic_ragnarok",tweakVar:"limit",description:"Limits the maximum number of Epic Ragnarok units."},{label:"Epic Calamity",type:"numeric-tweak",column:"left",defaultValue:"80",min:0,unitLabel:"max/unit",tweakTemplateId:"tweak_limit_epic_calamity",tweakVar:"limit",description:"Limits the maximum number of Epic Calamity units."},{label:"Epic Tyrannus",type:"numeric-tweak",column:"left",defaultValue:"80",min:0,unitLabel:"max/unit",tweakTemplateId:"tweak_limit_epic_tyrannus",tweakVar:"limit",description:"Limits the maximum number of Epic Tyrannus units."},{label:"Epic Starfall",type:"numeric-tweak",column:"left",defaultValue:"80",min:0,unitLabel:"max/unit",tweakTemplateId:"tweak_limit_epic_starfall",tweakVar:"limit",description:"Limits the maximum number of Epic Starfall units."},{label:"Game Multipliers",type:"header",column:"left"},{label:"Resource Income",type:"numeric-tweak",column:"left",defaultValue:"2",min:0,step:.1,modOption:"multiplier_resourceincome",description:"Global multiplier for resource income."},{label:"Shield Power",type:"numeric-tweak",column:"left",defaultValue:"2",min:0,step:.1,modOption:"multiplier_shieldpower",description:"Global multiplier for shield strength."},{label:"Build Range",type:"numeric-tweak",column:"left",defaultValue:"2",min:0,step:.1,modOption:"multiplier_builddistance",description:"Global multiplier for unit build range."},{label:"Build Power",type:"numeric-tweak",column:"left",defaultValue:"2",min:0,step:.1,modOption:"multiplier_buildpower",description:"Global multiplier for unit build power."},{label:"Raptor Settings",type:"header",column:"left"},{label:"Queen Quantity",type:"numeric-tweak",column:"left",defaultValue:"25",min:0,step:1,modOption:"raptor_queen_count",description:"Number of Queen units to spawn."},{label:"Wave Multiplier",type:"numeric-tweak",column:"left",defaultValue:"4",min:0,step:.1,modOption:"raptor_spawncountmult",description:"Multiplier for the number of Raptors in each wave."},{label:"First Waves Boost",type:"numeric-tweak",column:"left",defaultValue:"4",min:0,step:1,modOption:"raptor_firstwavesboost",description:"Multiplier for the intensity of the first few waves."},{label:"Grace Period Multiplier",type:"numeric-tweak",column:"left",defaultValue:"3",min:0,step:.1,modOption:"raptor_graceperiodmult",description:"Multiplier for the duration of the initial grace period."}];var n=function(e,t,a,n){return new(a||(a=Promise))(function(o,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function i(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(s,i)}l((n=n.apply(e,t||[])).next())})};function o(){return n(this,void 0,void 0,function*(){return{rawOptionsData:[],formOptionsConfig:t}})}function r(){return n(this,void 0,void 0,function*(){try{const e=yield fetch(`links.md?t=${Date.now()}`);if(!e.ok)return"";const t=yield e.text();return"undefined"!=typeof marked&&marked.parse?marked.parse(t):t}catch(e){return console.error("Failed to load links content",e),""}})}function s(t){return n(this,void 0,void 0,function*(){return e})}const i="nuttyb-custom-tweaks";let l=[];function c(e){l=e,localStorage.setItem(i,JSON.stringify(l))}function u(){return l}const d=JSON.parse('{"qhp":{"name":"Queen Health & Repair","description":"Queen Health & Repair Adjustments","scope":"UnitDefsLoop","conditions":[{"type":"nameStartsWith","prefix":"raptor_queen_"}],"mutations":[{"op":"set","field":"repairable","value":false},{"op":"set","field":"canbehealed","value":false},{"op":"set","field":"buildTime","value":9999999},{"op":"set","field":"autoHeal","value":2},{"op":"set","field":"canSelfRepair","value":false},{"op":"multiply","field":"health","factor":{"type":"variable","key":"multiplier"}}]},"raptor_swarmer_heal":{"name":"Swarmer Heal Adjustments","description":"Swarmer Heal adjustments","scope":"UnitDefsLoop","conditions":[{"type":"nameMatch","regex":"^raptor_land_swarmer_heal"}],"mutations":[{"op":"set","field":"reclaimSpeed","value":100},{"op":"set","field":"stealth","value":false},{"op":"set","field":"builder","value":false},{"op":"multiply","field":"buildSpeed","factor":{"type":"variable","key":"workertimeMultiplier"}},{"op":"set","field":"canAssist","value":false},{"op":"set","field":"maxThisUnit","value":0}]},"raptor_health":{"name":"Raptor Health Adjustments","description":"Raptor Health adjustments","scope":"UnitDefsLoop","conditions":[{"type":"customParam","key":"subfolder","value":"other/raptors"},{"type":"nameNotMatch","regex":"^raptor_queen_.*"}],"mutations":[{"op":"multiply","field":"health","factor":{"type":"variable","key":"healthMultiplier"}}]},"raptor_metal_chase":{"name":"Raptor Metal & Chase","description":"Metal Cost and NoChase","scope":"UnitDefsLoop","conditions":[{"type":"customParam","key":"subfolder","value":"other/raptors"}],"mutations":[{"op":"set","field":"noChaseCategory","value":"OBJECT"},{"op":"assign_math_floor","target":"metalCost","source":"health","factor":{"type":"variable","key":"metalCostFactor"}}]},"boss_hp":{"name":"Scav Boss HP","description":"Scavenger Boss HP adjustment","scope":"UnitDef_Post","conditions":[{"type":"nameStartsWith","prefix":"scavengerbossv4"}],"mutations":[{"op":"multiply","field":"health","factor":{"type":"variable","key":"multiplier"}}]},"scav_hp_health":{"name":"Scavengers HP - Health","description":"Scavenger Health","scope":"UnitDef_Post","conditions":[{"type":"nameEndsWith","suffix":"_scav"},{"type":"nameNotMatch","regex":"^scavengerbossv4"}],"mutations":[{"op":"assign_math_floor","target":"health","source":"health","factor":{"type":"variable","key":"multiplier"}}]},"scav_hp_metal":{"name":"Scavengers HP - Metal & Category","description":"Scavenger Metal Cost and Category","scope":"UnitDef_Post","conditions":[{"type":"nameEndsWith","suffix":"_scav"}],"mutations":[{"op":"assign_math_floor","target":"metalCost","source":"metalCost","factor":{"type":"variable","key":"multiplier"}},{"op":"set","field":"noChaseCategory","value":"OBJECT"}]},"add_to_build_menu":{"name":"Add Unit to Factory","description":"Adds unit to build options","scope":"UnitDefsLoop","conditions":[{"type":"nameStartsWith","prefix":{"type":"variable","key":"factoryPrefix"}}],"mutations":[{"op":"list_append","field":"buildoptions","value":{"type":"variable","key":"unitName"}}]},"tweak_limit_t3builders":{"name":"Limit T3 Builders","description":"Limits T3 Builders","scope":"UnitDefsLoop","conditions":[{"type":"nameInList","names":["armconst3","corconst3","legconst3"]}],"mutations":[{"op":"set","field":"maxThisUnit","value":{"type":"variable","key":"limit"}}]},"tweak_limit_unit_launchers":{"name":"Limit Unit Launchers","description":"Limits Unit Launchers","scope":"UnitDefsLoop","conditions":[{"type":"nameInList","names":["armmeatball","corclogger"]}],"mutations":[{"op":"set","field":"maxThisUnit","value":{"type":"variable","key":"limit"}}]},"tweak_limit_epic_ragnarok":{"name":"Limit Ragnarok","description":"Limits Epic Ragnarok","scope":"UnitDefsLoop","conditions":[{"type":"nameMatch","regex":"ragnarok"}],"mutations":[{"op":"set","field":"maxThisUnit","value":{"type":"variable","key":"limit"}}]},"tweak_limit_epic_calamity":{"name":"Limit Calamity","description":"Limits Epic Calamity","scope":"UnitDefsLoop","conditions":[{"type":"nameMatch","regex":"calamity"}],"mutations":[{"op":"set","field":"maxThisUnit","value":{"type":"variable","key":"limit"}}]},"tweak_limit_epic_tyrannus":{"name":"Limit Tyrannus","description":"Limits Epic Tyrannus","scope":"UnitDefsLoop","conditions":[{"type":"nameMatch","regex":"tyrannus"}],"mutations":[{"op":"set","field":"maxThisUnit","value":{"type":"variable","key":"limit"}}]},"tweak_limit_epic_starfall":{"name":"Limit Starfall","description":"Limits Epic Starfall","scope":"UnitDefsLoop","conditions":[{"type":"nameMatch","regex":"starfall"}],"mutations":[{"op":"set","field":"maxThisUnit","value":{"type":"variable","key":"limit"}}]},"tweak_enable_unit_launchers":{"name":"Enable Unit Launchers","description":"Adds Unit Launchers to T2 Vehicle Plants","scope":"UnitDefsLoop","conditions":[{"type":"nameInList","names":["armavp","coravp","legavp"]}],"mutations":[{"op":"list_append","field":"buildoptions","value":"armmeatball"},{"op":"list_append","field":"buildoptions","value":"corclogger"}]}}');class p{constructor(){this.builder=[],this.indentLevel=0,this.usedGlobals=new Set}compile(e){this.builder=[],this.indentLevel=0,this.usedGlobals=new Set,this.scanGlobals(e),this.emitGlobals(),this.addStatement("");const t=e.filter(e=>"UnitDefsLoop"===e.tweak.scope),a=e.filter(e=>"UnitDef_Post"===e.tweak.scope),n=e.filter(e=>"Global"===e.tweak.scope);if(n.length>0)for(const e of n)for(const t of e.tweak.mutations)this.generateMutation(t,"nil",e.variables);if(t.length>0){this.startLoop("for id, def in pairs(UnitDefs)"),this.addLocal("name","def.name or id");let e=null;for(const a of t){const t=this.generateConditions(a.tweak.conditions,"name","def",a.variables),n=t.join(" && ");e&&e.conditions.join(" && ")===n?e.inputs.push(a):(e&&this.emitGroup(e,"def"),e={inputs:[a],conditions:t})}e&&this.emitGroup(e,"def"),this.endBlock()}if(a.length>0){const e="ApplyTweaks_Post";this.startBlock(`local function ${e}(name, def)`);let t=null;for(const e of a){const a=this.generateConditions(e.tweak.conditions,"name","def",e.variables),n=a.join(" && ");t&&t.conditions.join(" && ")===n?t.inputs.push(e):(t&&this.emitGroup(t,"def"),t={inputs:[e],conditions:a})}t&&this.emitGroup(t,"def"),this.endBlock(),this.addStatement(""),this.startIf("UnitDef_Post"),this.addLocal("prev_UnitDef_Post","UnitDef_Post"),this.startBlock("UnitDef_Post = function(name, def)"),this.addStatement("prev_UnitDef_Post(name, def)"),this.addStatement(`${e}(name, def)`),this.endBlock(),this.addElse(),this.addStatement(`UnitDef_Post = ${e}`),this.endBlock()}return this.builder.map(e=>e.trim()).filter(e=>""!==e&&!e.startsWith("--")).join("\n")}emitGroup(e,t){e.conditions.length>0&&this.startIf(e.conditions.join(" and "));const a=[];e.inputs.forEach(e=>e.tweak.mutations.forEach(t=>a.push({mut:t,vars:e.variables})));const n=[];for(const e of a){const t=n.length>0?n[n.length-1]:null;t&&"multiply"===t.mut.op&&"multiply"===e.mut.op&&(t.mut.field,e.mut.field),n.push(e)}const o=new Map,r=(e,a)=>{const n=a.join(" * "),o=e.split(".");if("customparams"===o[0].toLowerCase()&&o.length>1){const e=o[1];this.startIf(`${t}.customparams and ${t}.customparams["${e}"]`),this.addStatement(`${t}.customparams["${e}"] = ${t}.customparams["${e}"] * (${n})`),this.addElse(),this.startIf(`${t}.customParams and ${t}.customParams["${e}"]`),this.addStatement(`${t}.customParams["${e}"] = ${t}.customParams["${e}"] * (${n})`),this.endBlock(),this.endBlock()}else this.addStatement(`${t}.${e} = ${t}.${e} * (${n})`)},s=e=>{if(e)o.has(e)&&(r(e,o.get(e)),o.delete(e));else{for(const[e,t]of o)r(e,t);o.clear()}};for(const e of n){const{mut:a,vars:n}=e;if("set"!==a.op&&"assign_math_floor"!==a.op&&"remove"!==a.op||("field"in a&&s(a.field),"target"in a&&s(a.target)),"multiply"===a.op){const e=this.resolveValueSource(a.factor,n);o.has(a.field)||o.set(a.field,[]),o.get(a.field).push(e)}else s(),this.generateMutation(a,t,n)}s(),e.conditions.length>0&&this.endBlock()}generateMutation(e,t,a){if("set"===e.op)this.addFieldWrite(t,e.field,this.resolveValueSource(e.value,a));else if("multiply"===e.op){const n=this.resolveValueSource(e.factor,a);this.addFieldWrite(t,e.field,`${this.getFieldRead(t,e.field)} * (${n})`)}else if("remove"===e.op)this.addFieldWrite(t,e.field,"nil");else if("assign_math_floor"===e.op){const n=this.getFieldRead(t,e.source);this.startIf(n);const o=this.resolveValueSource(e.factor,a);this.addFieldWrite(t,e.target,`math_floor(${n} * ${o})`),this.endBlock()}else if("list_append"===e.op){const n=this.resolveValueSource(e.value,a),o="target_list";this.addLocal(o,this.getFieldRead(t,e.field)),this.startIf(`not ${o}`);const r=e.field.split(".");"customparams"===r[0].toLowerCase()&&r.length>1?(this.addStatement(`${t}.customparams = ${t}.customparams or {}`),this.addStatement(`${t}.customparams["${r[1]}"] = {}`),this.addStatement(`${o} = ${t}.customparams["${r[1]}"]`)):(this.addStatement(`${t}.${e.field} = {}`),this.addStatement(`${o} = ${t}.${e.field}`)),this.endBlock(),this.addStatement(`table_insert(${o}, ${n})`)}else if("modify_weapon"===e.op){const n=e.weaponName||"*";this.startIf(`${t}.weapondefs`),this.startLoop(`for wName, wDef in pairs(${t}.weapondefs)`),"*"!==n&&this.startIf(`wName == "${n}"`);for(const t of e.mutations)this.generateMutation(t,"wDef",a);"*"!==n&&this.endBlock(),this.endBlock(),this.endBlock()}else if("table_merge"===e.op){const n=this.resolveValueSource(e.value,a),o=e.field.split(".");if("customparams"===o[0].toLowerCase()&&o.length>1){const e=o[1];this.addStatement(`if not ${t}.customparams then ${t}.customparams = {} end`),this.addStatement(`if not ${t}.customparams["${e}"] then ${t}.customparams["${e}"] = {} end`),this.addStatement(`table_merge(${t}.customparams["${e}"], ${n})`)}else this.addStatement(`if not ${t}.${e.field} then ${t}.${e.field} = {} end`),this.addStatement(`table_merge(${t}.${e.field}, ${n})`)}else if("list_remove"===e.op){const n=this.resolveValueSource(e.value,a),o="target_list";this.addLocal(o,this.getFieldRead(t,e.field)),this.startIf(o),this.startLoop(`for i = #(${o}), 1, -1`),this.startIf(`${o}[i] == ${n}`),this.addStatement(`table_remove(${o}, i)`),this.endBlock(),this.endBlock(),this.endBlock()}else if("clone_unit"===e.op){const n="SELF"===e.source?t:`UnitDefs["${e.source}"]`,o=e.target?`"${e.target}"`:e.targetSuffix?`${t}.name .. "${e.targetSuffix}"`:"nil";if(this.startIf(n),this.addLocal("newDef",`table_merge({}, ${n})`),e.mutations)for(const t of e.mutations)this.generateMutation(t,"newDef",a);this.addStatement(`UnitDefs[${o}] = newDef`),this.endBlock()}}generateConditions(e,t,a,n){const o=[];for(const r of e)switch(r.type){case"nameMatch":o.push(`string_match(${t}, "${this.escapeLuaString(r.regex)}")`);break;case"nameNotMatch":o.push(`not string_match(${t}, "${this.escapeLuaString(r.regex)}")`);break;case"nameStartsWith":if("string"==typeof r.prefix?r.prefix:this.resolveValueSource(r.prefix,n).replace(/"/g,""),"string"!=typeof r.prefix){const e=this.resolveValueSource(r.prefix,n);o.push(`string_sub(${t}, 1, string_len(${e})) == ${e}`)}else o.push(`string_sub(${t}, 1, ${r.prefix.length}) == "${this.escapeLuaString(r.prefix)}"`);break;case"nameEndsWith":if("string"!=typeof r.suffix){const e=this.resolveValueSource(r.suffix,n);o.push(`string_sub(${t}, -string_len(${e})) == ${e}`)}else o.push(`string_sub(${t}, -${r.suffix.length}) == "${this.escapeLuaString(r.suffix)}"`);break;case"customParam":const e="object"==typeof r.value?this.resolveValueSource(r.value,n):"string"==typeof r.value?`"${this.escapeLuaString(r.value)}"`:r.value;o.push(`((${a}.customParams and ${a}.customParams["${r.key}"] == ${e}) or (${a}.customparams and ${a}.customparams["${r.key}"] == ${e}))`);break;case"customParamMatch":o.push(`((${a}.customParams and ${a}.customParams["${r.key}"] and string_match(${a}.customParams["${r.key}"], "${this.escapeLuaString(r.regex)}")) or (${a}.customparams and ${a}.customparams["${r.key}"] and string_match(${a}.customparams["${r.key}"], "${this.escapeLuaString(r.regex)}")))`);break;case"fieldValue":const s="object"==typeof r.value?this.resolveValueSource(r.value,n):"string"==typeof r.value?`"${r.value}"`:r.value;o.push(`${this.getFieldRead(a,r.field)} == ${s}`);break;case"category":const i="object"==typeof r.value?this.resolveValueSource(r.value,n):`"${r.value}"`;o.push(`string_match(${a}.category or "", ${i})`);break;case"nameInList":const l=r.names.map(e=>`${t} == "${e}"`);o.push(`(${l.join(" or ")})`)}return o}resolveValueSource(e,t){if("object"==typeof e&&null!==e){if("type"in e){const a=e;if("variable"===a.type){const e=t[a.key];if(void 0===e)throw new Error(`Variable ${a.key} not found`);return this.jsonToLua(e,t)}if("mod_option"===a.type)return`(Spring_GetModOptions().${a.key} or ${this.jsonToLua(a.default,t)})`;if("math"===a.type){let e=a.expression;for(const[n,o]of Object.entries(a.variables)){let a=this.resolveValueSource(o,t);if(a.startsWith('"')&&a.endsWith('"')){const e=a.slice(1,-1);/^[a-zA-Z_][a-zA-Z0-9_.]*$/.test(e)&&(a=e)}e=e.split(n).join(a)}return`(${this.transformMathExpression(e).code})`}}return this.jsonToLua(e,t)}return this.jsonToLua(e,t)}transformMathExpression(e){const t=new Set,a=e.split(/("(?:\\[\s\S]|[^"])*"|'(?:\\[\s\S]|[^'])*')/g);for(let e=0;e<a.length;e+=2)a[e]=a[e].replace(/\b(max|min|ceil|floor|abs|random|sqrt)(\s*\()/g,(e,a,n)=>(t.add(`math.${a}`),`math_${a}${n}`));return{code:a.join(""),globals:t}}escapeLuaString(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")}jsonToLua(e,t){if(null==e)return"nil";if("object"==typeof e&&null!==e&&"type"in e&&("variable"===e.type||"math"===e.type||"mod_option"===e.type))return this.resolveValueSource(e,t);if("string"==typeof e)return`"${this.escapeLuaString(e)}"`;if("number"==typeof e)return e.toString();if("boolean"==typeof e)return e?"true":"false";if(Array.isArray(e))return`{ ${e.map(e=>this.jsonToLua(e,t)).join(", ")} }`;if("object"==typeof e){const a=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(n)?n:`["${n}"]`;a.push(`${o} = ${this.jsonToLua(e[n],t)}`)}return`{ ${a.join(", ")} }`}return"{}"}scanGlobals(e){this.usedGlobals.add("pairs"),this.usedGlobals.add("ipairs"),this.usedGlobals.add("string.sub"),this.usedGlobals.add("string.match"),this.usedGlobals.add("string.len"),this.usedGlobals.add("table.insert"),this.usedGlobals.add("math.floor");for(const t of e)this.scanValueSource(t.tweak,t.variables)}scanValueSource(e,t){if(e&&"object"==typeof e){"mod_option"===e.type&&this.usedGlobals.add("Spring.GetModOptions"),"math"===e.type&&this.transformMathExpression(e.expression).globals.forEach(e=>this.usedGlobals.add(e)),"table_merge"!==e.type&&"clone_unit"!==e.type&&"table_merge"!==e.op&&"clone_unit"!==e.op||this.usedGlobals.add("table.merge"),"list_remove"===e.op&&this.usedGlobals.add("table.remove");for(const a in e)this.scanValueSource(e[a],t)}}emitGlobals(){this.usedGlobals.has("Spring.GetModOptions")&&this.addLocal("Spring_GetModOptions","Spring.GetModOptions"),this.usedGlobals.has("table.merge")&&this.addLocal("table_merge","table.merge");const e={pairs:"pairs",ipairs:"ipairs","string.sub":"string_sub","string.match":"string_match","string.len":"string_len","table.insert":"table_insert","table.remove":"table_remove","math.floor":"math_floor","math.ceil":"math_ceil","math.max":"math_max","math.min":"math_min","math.abs":"math_abs","math.random":"math_random","math.sqrt":"math_sqrt"};for(const t of this.usedGlobals)e[t]&&this.addLocal(e[t],t)}getIndent(){return"    ".repeat(this.indentLevel)}addStatement(e){this.builder.push(this.getIndent()+e)}addLocal(e,t){this.builder.push(`${this.getIndent()}local ${e} = ${t}`)}startLoop(e){this.builder.push(`${this.getIndent()}${e} do`),this.indentLevel++}startIf(e){this.builder.push(`${this.getIndent()}if ${e} then`),this.indentLevel++}addElse(){this.indentLevel--,this.builder.push(`${this.getIndent()}else`),this.indentLevel++}startBlock(e){this.builder.push(`${this.getIndent()}${e}`),this.indentLevel++}endBlock(){this.indentLevel--,this.builder.push(`${this.getIndent()}end`)}getFieldRead(e,t){const a=t.split(".");if("customparams"===a[0].toLowerCase()&&a.length>1){const t=a[1];return`((${e}.customParams and ${e}.customParams["${t}"]) or (${e}.customparams and ${e}.customparams["${t}"]))`}return`${e}.${t}`}addFieldWrite(e,t,a){const n=t.split(".");if("customparams"===n[0].toLowerCase()&&n.length>1){const t=n[1];this.startIf(`${e}.customparams`),this.addStatement(`${e}.customparams["${t}"] = ${a}`),this.addElse(),this.addStatement(`if not ${e}.customParams then ${e}.customParams = {} end`),this.addStatement(`${e}.customParams["${t}"] = ${a}`),this.endBlock()}else this.addStatement(`${e}.${t} = ${a}`)}}const m=[{tier:2,hpMult:16,outputMult:4.2,costMult:4,prevSuffix:""},{tier:3,hpMult:16,outputMult:4.2,costMult:4,prevSuffix:"_t2"},{tier:4,hpMult:16,outputMult:4.2,costMult:4,prevSuffix:"_t3"},{tier:5,hpMult:16,outputMult:4.2,costMult:4,prevSuffix:"_t4"}],f=[{name:"armsolar",label:"Solar Collector"},{name:"corsolar",label:"Solar Collector"},{name:"armwin",label:"Wind Generator"},{name:"corwin",label:"Wind Generator"},{name:"armmakr",label:"Metal Maker"},{name:"cormakr",label:"Metal Maker"},{name:"armllt",label:"Light Laser Tower"},{name:"corllt",label:"Light Laser Tower"}],h=[{suffix:"_compressed_x2",mult:2,label:"x2"},{suffix:"_compressed_x5",mult:5,label:"x5"},{suffix:"_compressed_x10",mult:10,label:"x10"}],b=["raptor_land_swarmer_basic_t1_v1","raptor_land_assault_basic_t2_v1","raptor_air_fighter_basic","raptor_hive_swarmer_basic","raptor_hive_assault_basic"],v=d;function y(e){const{gameConfigs:t,formOptionsConfig:a,mapsSelectValue:n,modesSelectValue:o,primaryModeSelectValue:r,scavHpSelectValue:s,scavHpSelectText:i,bossHpSelectValue:l,bossHpSelectText:c,formElements:u,raptorOptions:d}=e,y=[];if(""!==n){const e=t.maps[parseInt(n)];e&&e.commands&&y.push(...e.commands)}if(""!==o){const e=t.modes[parseInt(o)];e&&e.commands&&y.push(...e.commands)}const g=[],x=[],k=[];if(u.forEach(e=>{if(e.isCustom)e.checked&&e.customData&&x.push(e.customData);else if(e.tweakDefinition&&e.checked)k.push({tweak:e.tweakDefinition,variables:{}});else if(e.isHpGenerator||e.isScavHpGenerator){const t=parseFloat(e.value||"0");if(t>0){const a=e.hpType;if("qhp"===a)v.qhp&&k.push({tweak:v.qhp,variables:{multiplier:t,multiplierText:e.value}});else if("hp"===a){let a=1,n=.5;switch(t){case 1.3:a=.576923077,n=.5;break;case 1.5:a=.466666667,n=.5;break;case 1.7:a=.411764706,n=.5;break;case 2:a=.35,n=.5;break;case 2.5:a=.3,n=.6;break;case 3:a=.25,n=.55;break;case 4:a=.1875,n=.45;break;case 5:a=.15,n=.25;break;default:a=1,n=.5}v.raptor_swarmer_heal&&k.push({tweak:v.raptor_swarmer_heal,variables:{workertimeMultiplier:n,multiplierText:e.value}}),v.raptor_health&&k.push({tweak:v.raptor_health,variables:{healthMultiplier:t,multiplierText:e.value}}),v.raptor_metal_chase&&k.push({tweak:v.raptor_metal_chase,variables:{metalCostFactor:a,multiplierText:e.value}})}else"boss"===a?v.boss_hp&&k.push({tweak:v.boss_hp,variables:{multiplier:t,multiplierText:e.value}}):"scav"===a&&(v.scav_hp_health&&k.push({tweak:v.scav_hp_health,variables:{multiplier:t,multiplierText:e.value}}),v.scav_hp_metal&&k.push({tweak:v.scav_hp_metal,variables:{multiplier:t,multiplierText:e.value}}))}}else{let t=[];if("SELECT"!==e.tagName||e.id.includes("maps-select")||e.id.includes("modes-select")||e.id.includes("primary-mode-select")?e.checked&&e.commandBlocks&&(t=e.commandBlocks):e.value&&t.push(e.value),e.dataset.tweakTemplateId){const t=e.dataset.tweakTemplateId;if(v[t]){let a={};if(e.dataset.tweakVars)try{a=JSON.parse(e.dataset.tweakVars)}catch(e){console.error("Error parsing tweakVars JSON:",e)}else e.dataset.tweakVar&&e.value&&(a={[e.dataset.tweakVar]:parseFloat(e.value)||e.value});k.push({tweak:v[t],variables:a})}}e.dataset.modOption&&("checkbox"===e.type?t.push(`!bset ${e.dataset.modOption} ${e.checked?"1":"0"}`):e.value&&t.push(`!bset ${e.dataset.modOption} ${e.value}`)),t.forEach(e=>{e&&g.push(e.trim())})}}),g.includes("!bset fusion_mode 1")&&function(){const e=[];for(const t of f)for(const a of m){const n=2===a.tier?t.name:`${t.name}${a.prevSuffix}`,o=`${t.name}_t${a.tier}`,r=[{op:"multiply",field:"health",factor:a.hpMult},{op:"multiply",field:"metalCost",factor:a.costMult},{op:"multiply",field:"energyCost",factor:a.costMult},{op:"multiply",field:"buildTime",factor:a.costMult},{op:"multiply",field:"energyMake",factor:a.outputMult},{op:"multiply",field:"metalMake",factor:a.outputMult},{op:"multiply",field:"windGenerator",factor:a.outputMult},{op:"modify_weapon",weaponName:"*",mutations:[{op:"multiply",field:"damage.default",factor:a.outputMult}]},{op:"multiply",field:"footprintX",factor:1.5},{op:"multiply",field:"footprintZ",factor:1.5},{op:"set",field:"name",value:`${t.label} T${a.tier}`},{op:"table_merge",field:"customParams",value:{is_fusion_unit:!0,fusion_tier:a.tier,model_scale:1.5}}];e.push({name:`Generate ${o}`,description:`Generates T${a.tier} variant of ${t.name}`,scope:"Global",conditions:[],mutations:[{op:"clone_unit",source:n,target:o,mutations:r}]})}return e}().forEach(e=>k.push({tweak:e,variables:{}})),g.includes("!bset adaptive_spawner 1")&&function(){const e=[],t=[...b.map(e=>({name:e,label:e})),...f];for(const a of t)for(const t of h){const n=`${a.name}${t.suffix}`,o=t.mult>=5?1.5:1.2,r=[{op:"multiply",field:"health",factor:t.mult},{op:"multiply",field:"metalCost",factor:t.mult},{op:"multiply",field:"energyCost",factor:t.mult},{op:"multiply",field:"buildTime",factor:t.mult},{op:"multiply",field:"mass",factor:t.mult},{op:"multiply",field:"energyMake",factor:t.mult},{op:"multiply",field:"metalMake",factor:t.mult},{op:"multiply",field:"windGenerator",factor:t.mult},{op:"modify_weapon",weaponName:"*",mutations:[{op:"multiply",field:"damage.default",factor:t.mult},{op:"multiply",field:"areaOfEffect",factor:Math.sqrt(t.mult)}]},{op:"set",field:"name",value:`${a.label} ${t.label}`},{op:"table_merge",field:"customParams",value:{is_compressed_unit:!0,compression_factor:t.mult,model_scale:o,color_tint:"1 0.5 0.5"}}];t.mult>=5&&(r.push({op:"multiply",field:"footprintX",factor:1.5}),r.push({op:"multiply",field:"footprintZ",factor:1.5})),e.push({name:`Generate ${n}`,description:`Generates ${t.label} compressed variant of ${a.name}`,scope:"Global",conditions:[],mutations:[{op:"clone_unit",source:a.name,target:n,mutations:r}]})}return e}().forEach(e=>k.push({tweak:e,variables:{}})),k.length>0){const e=(new p).compile(k),t={valid:!0};if(t.valid){const t=unescape(encodeURIComponent(e)),a=btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");x.unshift({id:0,desc:"Optimized Config",type:"tweakdefs",tweak:a})}else console.error(`Lua validation failed for generated config: ${t.error}`)}const w=new Set,_=new Set,S=/!bset\s+(tweakdefs|tweakunits)([1-9])\b/;[...g].forEach(e=>{const t=e.match(S);if(t){const e=parseInt(t[2],10);"tweakdefs"===t[1]?w.add(e):"tweakunits"===t[1]&&_.add(e)}});const C=[];x.forEach(e=>{const t="tweakdefs"===e.type?w:_;let a=null;for(let e=1;e<=9;e++)if(!t.has(e)){a=e;break}null!==a?(C.push(`!bset ${e.type}${a} ${e.tweak}`),t.add(a)):console.warn(`All slots for '${e.type}' are full. Could not add custom tweak.`)});const $=y.length>0||g.length>0||C.length>0,E=[],L=y.length>0||g.length>0||C.length>0,T=!1!==e.isMainTweaksEnabled;L&&(T&&t.base.length>0&&E.push(...t.base),"Scavengers"===r&&t.scavengers.length>0&&E.push(...t.scavengers)),E.push(...y,...g,...C);const M="Scavengers"===r;let P=M?"$rename [Mod] NuttyB Scavengers ":"$rename [Mod] NuttyB Raptors ";const H=[];if(M){const e=[i,c].filter(Boolean).join(" ");if(e){const t=e.replace(/\./g,"_");H.push(`[${t}]`)}}else{let e="",t="",n="";d.forEach(o=>{if(o.value){const r=a.find(e=>e.label===o.optionType);if(r&&r.choices){const a=r.choices.find(e=>e.value===o.value);a&&void 0!==a.shortLabel&&("Extras"===r.label?e=a.shortLabel:"Raptor Health"===r.label?t=a.shortLabel:"Queen Health"===r.label&&(n=a.shortLabel))}}}),e&&H.push(e);const o=[n,t].filter(Boolean).join(" ");o&&H.push(`[${o}]`)}const B=E.lastIndexOf("!unit_restrictions_noextractors 1"),A=E.lastIndexOf("!unit_restrictions_noextractors 0"),I=B>-1&&B>A;H.length>0&&(P+=H.join("")),I&&(P+="[No Mex]");const O=[],V=E;for(const e of V){if(!e)continue;let t=!1;for(const a of O){const n=0===a.length?e.length:e.length+1;if(a.length+n<=5e4){a.commands.push(e),a.length+=n,t=!0;break}}t||O.push({commands:[e],length:e.length})}if($)if(0===O.length)O.push({commands:[P],length:P.length});else{const e=O[O.length-1],t=0===e.length?P.length:P.length+1;e.length+t<=5e4?(e.commands.push(P),e.length+=t):O.push({commands:[P],length:P.length})}return{lobbyName:$?P:"No Options Selected",sections:O.map(e=>e.commands.join("\n"))}}var g=a(729),x=a.n(g);const k=d;function w(e){const t=document.querySelector("#custom-tweaks-table tbody");t.innerHTML="",0!==e.length?e.forEach(e=>{t.insertRow().innerHTML=`<td title="${e.desc}">${e.desc}</td><td title="${e.type}">${e.type}</td><td><div class="command-cell-wrapper"><span class="command-text" title="${e.tweak}">${e.tweak}</span><button class="copy-row-button" data-tweak-code="${e.tweak}">Copy</button></div></td><td><button class="delete-tweak-btn" data-id="${e.id}">Delete</button></td>`}):t.innerHTML='<tr><td colspan="4" style="text-align: center;">No custom tweaks saved</td></tr>'}function _(e){const t=document.querySelector("#data-table tbody");t.innerHTML="",e.filter(e=>"Hidden"!==e.status).forEach(e=>{const a=t.insertRow();a.insertCell().textContent=e.label,a.insertCell().textContent=e.status,a.insertCell().textContent=e.summary;const n=a.insertCell(),o=document.createElement("div");o.className="command-cell-wrapper";const r=document.createElement("span");r.className="command-text",r.textContent=e.commandBlock,r.title=e.commandBlock;const s=document.createElement("button");s.textContent="Copy",s.className="copy-row-button",s.dataset.command=e.commandBlock,o.appendChild(r),o.appendChild(s),n.appendChild(o)}),document.querySelectorAll("select[data-slot]").forEach(e=>{const a=e,n=a.value;if(!n)return;const o=a.options[a.selectedIndex].text,r=a.dataset.hpType,s=a.dataset.slot,i=`${a.dataset.slotType}${s}`,l=function(e,t){const a=parseFloat(t);if(isNaN(a))return"Error: Invalid multiplier";try{const n=[];if("qhp"===e)k.qhp&&n.push({tweak:k.qhp,variables:{multiplier:a,multiplierText:t}});else if("boss"===e)k.boss_hp&&n.push({tweak:k.boss_hp,variables:{multiplier:a,multiplierText:t}});else if("hp"===e){let e=1,o=.5;switch(a){case 1.3:e=.576923077,o=.5;break;case 1.5:e=.466666667,o=.5;break;case 1.7:e=.411764706,o=.5;break;case 2:e=.35,o=.5;break;case 2.5:e=.3,o=.6;break;case 3:e=.25,o=.55;break;case 4:e=.1875,o=.45;break;case 5:e=.15,o=.25;break;default:e=1,o=.5}k.raptor_swarmer_heal&&n.push({tweak:k.raptor_swarmer_heal,variables:{workertimeMultiplier:o,multiplierText:t}}),k.raptor_health&&n.push({tweak:k.raptor_health,variables:{healthMultiplier:a,multiplierText:t}}),k.raptor_metal_chase&&n.push({tweak:k.raptor_metal_chase,variables:{metalCostFactor:e,multiplierText:t}})}else{if("scav"!==e)return"Error: Unknown type";k.scav_hp_health&&n.push({tweak:k.scav_hp_health,variables:{multiplier:a,multiplierText:t}}),k.scav_hp_metal&&n.push({tweak:k.scav_hp_metal,variables:{multiplier:a,multiplierText:t}})}if(n.length>0){const e=(new p).compile(n);let t=e;const a=e.match(/^(--.*)\n/),o=a?a[1]:"",r=x().minify(e);return t=o?o+"\n"+r:r,function(e){const t=unescape(encodeURIComponent(e));return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}(t)}}catch(e){return"Error: "+e}return"Error: Unknown type"}(r,n);if(l.startsWith("Error"))return;const c=`!bset ${i} ${l}`,u=function(e){if(!e)return"";try{let t=e.replace(/-/g,"+").replace(/_/g,"/");const a=t.length%4;a&&(t+="====".slice(a));const n=atob(t),o=Uint8Array.from(n,e=>e.charCodeAt(0));return new TextDecoder("utf-8").decode(o)}catch(t){return console.error(`Base64URL decoding failed for: ${e}`,t),"Error decoding data"}}(l).split("\n")[0].trim(),d=t.insertRow();d.insertCell().textContent=o,d.insertCell().textContent="Optional/Generated",d.insertCell().textContent=u;const m=d.insertCell(),f=document.createElement("div");f.className="command-cell-wrapper";const h=document.createElement("span");h.className="command-text",h.textContent=c,h.title=c;const b=document.createElement("button");b.textContent="Copy",b.className="copy-row-button",b.dataset.command=c,f.appendChild(h),f.appendChild(b),m.appendChild(f)})}let S=[],C=[],$={maps:[],modes:[],base:[],scavengers:[]};const E=D("lobby-name-display"),L=(document.querySelectorAll(".copy-button"),R("#data-table tbody")),T=D("custom-tweak-form"),M=R("#custom-tweaks-table tbody"),P=R("#maps-modes-table tbody"),H=document.querySelectorAll(".tab-button"),B=document.querySelectorAll(".tab-content"),A=D("reset-none-btn"),I=D("reset-default-btn"),O=D("options-form-columns");function V(e){const t=R("#primary-mode-select"),a=R("#raptor-only-options"),n=R("#scav-only-options"),o=R("#scav-hp-select"),r=R("#boss-hp-select"),s=R("#maps-select"),i=R("#modes-select");if(t&&a&&n){const s=t.value;e&&e.target===t&&("Scavengers"===s?(o&&(o.value="1.3"),r&&(r.value="1.3"),a.querySelectorAll("select, input").forEach(e=>e.value="")):(o&&(o.value=""),r&&(r.value=""),a.querySelectorAll("select, input").forEach(e=>{const t=e;let a=C.find(e=>e.label===t.dataset.optionType);!a&&t.dataset.modOption&&(a=C.find(e=>e.modOption===t.dataset.modOption)),!a&&t.dataset.tweakTemplateId&&(a=C.find(e=>e.tweakTemplateId===t.dataset.tweakTemplateId)),a&&(e.value=a.defaultValue||"")})));const i="Scavengers"===s;a.style.display=i?"none":"block",n.style.display=i?"block":"none"}!function(){const e=document.getElementById("slot-warning-messages"),t=new Set,a=new Set,n=/!bset\s+(tweakdefs|tweakunits)([1-9])\b/;document.querySelectorAll('#options-form-columns input[type="checkbox"], #options-form-columns select').forEach(e=>{const o=e;if(o.dataset.isCustom)return;if((o.dataset.isHpGenerator||o.dataset.isScavHpGenerator)&&o.value&&o.dataset.slot){const e=parseInt(o.dataset.slot,10);return void(isNaN(e)||("tweakdefs"===o.dataset.slotType?t.add(e):"tweakunits"===o.dataset.slotType&&a.add(e)))}let r=[];"SELECT"===o.tagName&&o.value?r.push(o.value):"checkbox"===o.type&&o.checked&&(r=JSON.parse(o.dataset.commandBlocks||"[]")),r.forEach(e=>{if(!e)return;const o=e.match(n);if(o){const e=parseInt(o[2],10);"tweakdefs"===o[1]?t.add(e):"tweakunits"===o[1]&&a.add(e)}})});const o=document.querySelectorAll('input[data-is-custom="true"]');o.forEach(e=>{const n=e,o=n.nextElementSibling.nextElementSibling,r=n.nextElementSibling,s=JSON.parse(n.dataset.customData);if(r.classList.remove("disabled"),n.checked){const e="tweakdefs"===s.type?t:a;let n=null;for(let t=1;t<=9;t++)if(!e.has(t)){n=t;break}null!==n?(o.textContent=`(${s.type}${n})`,e.add(n)):o.textContent=`(${s.type} - No Slot!)`}else o.textContent=`(${s.type})`});let r=9-t.size,s=9-a.size;o.forEach(e=>{const t=e;if(!t.checked){const e=JSON.parse(t.dataset.customData);let a=!1;"tweakdefs"===e.type&&r<=0&&(a=!0),"tweakunits"===e.type&&s<=0&&(a=!0),t.disabled=a,t.nextElementSibling.classList.toggle("disabled",a)}}),e.innerHTML="";const i=1===Math.max(0,r)?"slot":"slots",l=1===Math.max(0,s)?"slot":"slots",c=document.createElement("p");c.textContent=`${Math.max(0,r)} available tweakdefs ${i} and ${Math.max(0,s)} available tweakunits ${l}`,e.appendChild(c)}();const l=Array.from(document.querySelectorAll('#options-form-columns input[type="checkbox"], #options-form-columns input[type="number"], #options-form-columns select, #custom-options-form-columns input[type="checkbox"]')).map(e=>{const t=e;return{isCustom:"true"===t.dataset.isCustom,customData:t.dataset.customData?JSON.parse(t.dataset.customData):void 0,isHpGenerator:"true"===t.dataset.isHpGenerator,isScavHpGenerator:"true"===t.dataset.isScavHpGenerator,value:t.value,checked:t.checked,hpType:t.dataset.hpType,slot:t.dataset.slot,slotType:t.dataset.slotType,tagName:t.tagName,type:t.type,id:t.id,dataset:t.dataset,commandBlocks:t.dataset.commandBlocks?JSON.parse(t.dataset.commandBlocks):void 0}}),c=Array.from(document.querySelectorAll("#raptor-only-options select")).map(e=>({value:e.value,optionType:e.dataset.optionType||""})),u=document.querySelector('input[data-option-label="NuttyB Main Tweaks"]'),d=y({isMainTweaksEnabled:!u||u.checked,gameConfigs:$,formOptionsConfig:C,mapsSelectValue:s?s.value:"",modesSelectValue:i?i.value:"",primaryModeSelectValue:t?t.value:"Raptors",scavHpSelectValue:o?o.value:"",scavHpSelectText:o&&o.options[o.selectedIndex]?o.options[o.selectedIndex].text:"",bossHpSelectValue:r?r.value:"",bossHpSelectText:r&&r.options[r.selectedIndex]?r.options[r.selectedIndex].text:"",formElements:l,raptorOptions:c});E.textContent=d.lobbyName;for(let e=1;e<=7;e++){const t=D(`part-${e}-section`),a=D(`command-output-${e}`);d.sections[e-1]?(a.value=d.sections[e-1],t.style.display="grid"):(a.value="",t.style.display="none")}}function N(e){const t=e.target,a=t.dataset.tab+"-tab";H.forEach(e=>e.classList.remove("active")),B.forEach(e=>e.classList.remove("active")),t.classList.add("active"),D(a).classList.add("active"),"data"===t.dataset.tab&&(_(S),function(e){const t=document.querySelector("#maps-modes-table tbody");if(t.innerHTML="",0===e.maps.length&&0===e.modes.length&&0===e.scavengers.length&&0===e.base.length)return void(t.innerHTML='<tr><td colspan="3" style="text-align: center;">No maps or modes found.</td></tr>');const a=(e,t)=>{if(!t||0===t.length)return void(e.textContent="N/A");const a=document.createElement("div");a.className="command-cell-wrapper";const n=document.createElement("span");n.style.whiteSpace="normal",n.innerHTML=t.join("<br>");const o=document.createElement("button");o.textContent="Copy All",o.className="copy-row-button",o.dataset.command=t.join("\n"),a.appendChild(n),a.appendChild(o),e.appendChild(a)},n=(e,n)=>{e.forEach(e=>{const o=t.insertRow();o.insertCell().textContent=n,o.insertCell().textContent=e.name,a(o.insertCell(),e.commands)})},o=(e,n,o)=>{if(e.length>0){const r=t.insertRow();r.insertCell().textContent=n,r.insertCell().textContent=o,a(r.insertCell(),e)}};o(e.base,"base","Raptors (Default)"),o(e.scavengers,"scavengers","Default"),n(e.maps,"maps"),n(e.modes,"modes")}($)),"custom"===t.dataset.tab&&w(u())}function G(){w(u()),function(e,t){const a=document.getElementById("custom-left-column"),n=document.getElementById("custom-right-column"),o=document.getElementById("custom-settings-container");a.innerHTML="",n.innerHTML="",e.length>0?(o.style.display="block",e.forEach((e,o)=>{const r=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.dataset.isCustom="true",s.dataset.customData=JSON.stringify({type:e.type,tweak:e.tweak}),s.addEventListener("change",t);const i=document.createElement("span");i.className="custom-option-label-text",i.textContent=` ${e.desc}`;const l=document.createElement("span");l.className="custom-option-type-display",l.textContent=`(${e.type})`,r.appendChild(s),r.appendChild(i),r.appendChild(l),o%2==0?a.appendChild(r):n.appendChild(r)})):o.style.display="none"}(u(),V)}function D(e){const t=document.getElementById(e);if(!t)throw new Error(`Element with id '${e}' not found.`);return t}function R(e,t=document){return t.querySelector(e)}document.addEventListener("click",e=>{const t=e.target;if(t.matches(".copy-button")){const e=t.dataset.target;if(!e)return;const a=D(e);if(!a)return;const n=t.textContent;navigator.clipboard.writeText(a.value).then(()=>{t.textContent="Copied!",setTimeout(()=>{t.textContent=n},2e3)}).catch(e=>{console.error("Failed to copy: ",e)})}}),[L,M,P].forEach(e=>{e&&e.addEventListener("click",e=>{const t=e.target;if(t.matches(".copy-row-button")){const e=t.dataset.command||t.dataset.tweakCode;if(!e)return;navigator.clipboard.writeText(e).then(()=>{const e=t.textContent;t.textContent="Copied!",setTimeout(()=>{t.textContent=e},2e3)}).catch(e=>{console.error("Failed to copy command: ",e)})}else t.matches(".delete-tweak-btn")&&(function(e){l=l.filter(t=>t.id!==e),c(l)}(parseInt(t.dataset.id,10)),G(),V())})}),A.addEventListener("click",()=>{document.querySelectorAll('#options-form-columns input[type="checkbox"], #options-form-columns input[type="number"], #options-form-columns select').forEach(e=>{const t=e;if("checkbox"===t.type)t.checked=!1;else if("SELECT"===t.tagName)"maps-select"===t.id||"modes-select"===t.id?t.selectedIndex=-1:"primary-mode-select"!==t.id&&(t.value="");else if("number"===t.type){const e=t.dataset.tweakTemplateId;if(e){const a=C.find(t=>t.tweakTemplateId===e);t.value=a&&a.defaultValue||""}else t.value=""}}),V()}),I.addEventListener("click",()=>{const e=R("#primary-mode-select");e&&(e.value="Raptors");const t=new Map;document.querySelectorAll("#options-form-columns label").forEach(e=>{var a;const n=null===(a=e.textContent)||void 0===a?void 0:a.trim();n&&t.set(n,e)}),C.forEach(e=>{if("checkbox"===e.type){const a=t.get(e.label);if(a){const t=a.querySelector('input[type="checkbox"]');t&&(t.checked=!!e.default)}}else if("select"===e.type){const t=O.querySelector(`select[data-option-type="${e.label}"]`);t&&(t.value=e.defaultValue||"")}else if("numeric-tweak"===e.type&&e.tweakTemplateId){const t=O.querySelector(`input[data-tweak-template-id="${e.tweakTemplateId}"]`);t&&(t.value=e.defaultValue||"")}});const a=R("#boss-hp-select"),n=R("#scav-hp-select");a&&(a.value=""),n&&(n.value="");const o=R("#maps-select");o&&o.options.length>0&&(o.selectedIndex=0);const r=R("#modes-select");r&&r.options.length>0&&(r.selectedIndex=0),V()}),T.addEventListener("submit",function(e){var t,a,n;e.preventDefault(),t=D("custom-option-desc").value.trim(),a=D("custom-option-type").value,n=D("custom-tweak-code").value.trim(),t&&n&&(l.push({id:Date.now(),desc:t,type:a,tweak:n}),c(l)),G(),V(),T.reset()}),H.forEach(e=>e.addEventListener("click",N)),document.addEventListener("DOMContentLoaded",function(){return e=this,t=void 0,n=function*(){try{!function(){const e=localStorage.getItem(i);l=e?JSON.parse(e):[]}();const[e,t,a]=yield Promise.all([s(),o(),r()]);$=e,S=t.rawOptionsData,C=t.formOptionsConfig,a&&(D("links-tab").innerHTML=a),console.log("Modes file loaded and parsed:",$),function(e,t,a){const n=document.getElementById("left-column"),o=document.getElementById("right-column");document.getElementById("options-form-columns"),n.innerHTML="",o.innerHTML="";const r=new Map(e.map(e=>[e.label,e])),s=["NuttyB Main Tweaks","NuttyB Evolving Commanders"],i=new Set(s);s.forEach(e=>{const t=r.get(e);if(t){const e=document.createElement("label");t.description&&(e.title=t.description);const o=document.createElement("input");o.type="checkbox",o.dataset.commandBlocks=JSON.stringify(t.commandBlocks),t.tweakTemplateId&&(o.dataset.tweakTemplateId=t.tweakTemplateId),o.dataset.optionLabel=t.label,o.checked=!!t.default,o.disabled=!!t.disabled,e.appendChild(o),e.appendChild(document.createTextNode(" "+t.label)),o.disabled||o.addEventListener("change",a),n.appendChild(e)}});const l=document.createElement("label");l.textContent="Mode: ";const c=document.createElement("select");c.id="primary-mode-select",c.innerHTML='<option value="Raptors">Raptors</option><option value="Scavengers">Scavengers</option>',c.addEventListener("change",e=>a(e)),l.appendChild(c),n.appendChild(l);const u=document.createElement("div");u.id="scav-only-options";const d=document.createElement("label");d.textContent="Scavengers HP: ";const p=document.createElement("select");p.id="scav-hp-select",p.dataset.isScavHpGenerator="true",p.dataset.hpType="scav",p.dataset.slot="",p.dataset.slotType="tweakdefs",[{v:"",t:"Default"},{v:"1",t:"1x HP"},{v:"1.3",t:"1.3x HP"},{v:"1.5",t:"1.5x HP"},{v:"1.7",t:"1.7x HP"},{v:"2",t:"2x HP"},{v:"2.5",t:"2.5x HP"},{v:"3",t:"3x HP"},{v:"4",t:"4x HP"},{v:"5",t:"5x HP"}].forEach(e=>p.add(new Option(e.t,e.v))),p.value="",p.addEventListener("change",a),d.appendChild(p),u.appendChild(d);const m=document.createElement("label");m.textContent="Scav Boss HP: ";const f=document.createElement("select");f.id="boss-hp-select",f.dataset.isScavHpGenerator="true",f.dataset.hpType="boss",f.dataset.slot="1",f.dataset.slotType="tweakdefs",[{v:"",t:"Default"},{v:"1",t:"1x BHP"},{v:"1.3",t:"1.3x BHP"},{v:"1.5",t:"1.5x BHP"},{v:"1.7",t:"1.7x BHP"},{v:"2",t:"2x BHP"},{v:"2.5",t:"2.5x BHP"},{v:"3",t:"3x BHP"},{v:"4",t:"4x BHP"},{v:"5",t:"5x BHP"}].forEach(e=>f.add(new Option(e.t,e.v))),f.value="",f.addEventListener("change",a),m.appendChild(f),u.appendChild(m),n.appendChild(u);const h=document.createElement("div");if(h.id="raptor-only-options",n.appendChild(h),e.forEach(e=>{var t;if(i.has(e.label))return;if("Scavengers HP"===e.label||"Boss HP"===e.label)return;const r=new Set(["Raptor Health","Queen Health","Extras","Raptor Settings","Queen Quantity","Wave Multiplier","First Waves Boost","Grace Period Multiplier"]);if("header"===e.type){const t=document.createElement("h3");return t.textContent=e.label,void(r.has(e.label)||"Raptor Settings"===e.label?h.appendChild(t):"right"===e.column?o.appendChild(t):n.appendChild(t))}const s=document.createElement("label");let l;e.description&&(s.title=e.description),"checkbox"===e.type?(l=document.createElement("input"),l.type="checkbox",l.dataset.commandBlocks=JSON.stringify(e.commandBlocks),e.tweakTemplateId&&(l.dataset.tweakTemplateId=e.tweakTemplateId),e.modOption&&(l.dataset.modOption=e.modOption),l.dataset.optionLabel=e.label,l.checked=!!e.default,l.disabled=!!e.disabled,s.appendChild(l),s.appendChild(document.createTextNode(" "+e.label)),l.disabled||l.addEventListener("change",a)):"numeric-tweak"===e.type?(l=document.createElement("input"),l.type="number",void 0!==e.min&&(l.min=String(e.min)),void 0!==e.max&&(l.max=String(e.max)),void 0!==e.step&&(l.step=String(e.step)),l.value=e.defaultValue||"",e.tweakTemplateId&&(l.dataset.tweakTemplateId=e.tweakTemplateId),e.tweakVar&&(l.dataset.tweakVar=e.tweakVar),e.modOption&&(l.dataset.modOption=e.modOption),l.dataset.optionLabel=e.label,s.textContent=e.label+": ",s.appendChild(l),e.unitLabel&&s.appendChild(document.createTextNode(" "+e.unitLabel)),l.addEventListener("input",a)):"select"===e.type&&(l=document.createElement("select"),l.dataset.optionType=e.label,l.dataset.optionLabel=e.label,e.isHpGenerator&&(l.dataset.isHpGenerator="true",l.dataset.hpType=e.hpType,l.dataset.slot=String(e.slot),l.dataset.slotType=e.slotType,l.disabled=!0),null===(t=e.choices)||void 0===t||t.forEach(t=>{const a=document.createElement("option");a.value=t.value,a.textContent=t.label,e.defaultValue&&t.value===e.defaultValue&&(a.selected=!0),a.dataset.shortLabel=t.shortLabel||"",l.appendChild(a)}),s.textContent=e.label+": ",s.appendChild(l),l.addEventListener("change",a)),"right"===e.column?o.appendChild(s):r.has(e.label)?h.appendChild(s):n.appendChild(s)}),t&&(t.maps.length>0||t.modes.length>0)){let e,o;if(t.maps.length>0){e=document.createElement("label"),e.textContent="Map: ";const n=document.createElement("select");n.id="maps-select",t.maps.forEach((e,t)=>{n.add(new Option(e.name,String(t)))}),n.selectedIndex=0,n.addEventListener("change",a),e.appendChild(n)}if(t.modes.length>0){o=document.createElement("label"),o.textContent="Start: ";const e=document.createElement("select");e.id="modes-select",e.addEventListener("change",a),o.appendChild(e)}const r=document.getElementById("raptor-only-options");r?(o&&r.after(o),e&&r.after(e)):(e&&n.appendChild(e),o&&n.appendChild(o))}}(C,$,V),document.querySelectorAll('select[data-is-hp-generator="true"], select[data-is-scav-hp-generator="true"]').forEach(e=>{e.disabled=!1}),V(),G(),function(e,t){const a=document.getElementById("modes-select");if(!a)return;const n=a.value;a.innerHTML="",e&&e.modes&&(e.modes.forEach((e,t)=>{const n=document.createElement("option");n.value=String(t),n.textContent=e.name,a.appendChild(n)}),Array.from(a.options).some(e=>e.value===n)?a.value=n:a.options.length>0&&(a.selectedIndex=0)),t()}($,V),D("reset-output").value=Array.from({length:9},(e,t)=>`!bset tweakdefs${t+1} ""\n!bset tweakunits${t+1} ""`).join("\n")}catch(e){console.error("Failed to initialize the configurator:",e),document.querySelector(".container").innerHTML='<h1>Initialization Error</h1><p style="color: red;">Could not load essential configuration files (e.g., modes.txt or tweakdata.txt). Please check that the files exist and refresh the page.</p>'}},new((a=void 0)||(a=Promise))(function(o,r){function s(e){try{l(n.next(e))}catch(e){r(e)}}function i(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(s,i)}l((n=n.apply(e,t||[])).next())});var e,t,a,n})})()})();